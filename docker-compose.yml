services:
  stt_gpu:
    build:
      context: ./Whisper-STT-GPU
    ports:
      - "5002:5001"
    container_name: stt-service-gpu
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 1
              capabilities: [gpu]

  deepseek:
    build:
      context: ./DeepSeek
    ports:
      - "5000:30000"
    container_name: deepseek-app
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 1
              capabilities: [gpu]

  vectordb:
    build:
      context: ./VectorDB
    ports:
      - "5001:5001"
    container_name: vector-db

  nginx:
    image: nginx:latest
    container_name: nginx
    ports:
      - "80:80"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
    depends_on:
      - deepseek
      - stt_gpu
      - vectordb